<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • BioPlexAnalysis</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="BioPlexAnalysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioPlexAnalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/BioNet.html">BioNet analysis</a>
</li>
<li>
  <a href="../articles/PFAM.html">PFAM analysis</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ccb-hms/BioPlexAnalysis">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="PFAM_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      
      <div class="hidden name"><code>PFAM.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BioPlex</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/AnnotationDbi">AnnotationDbi</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">AnnotationHub</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></code></pre></div>
<p>Get the latest version of the 293T PPI network:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.293t</span> <span class="op">&lt;-</span> <span class="fu">BioPlex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BioPlex/man/getBioPlex.html">getBioPlex</a></span><span class="op">(</span>cell.line <span class="op">=</span> <span class="st">"293T"</span>, version <span class="op">=</span> <span class="st">"3.0"</span><span class="op">)</span></code></pre></div>
<pre><code>## Using cached version from 2021-06-03 07:06:54</code></pre>
<p>and turn into a graph object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.gr</span> <span class="op">&lt;-</span> <span class="fu">BioPlex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BioPlex/man/bioplex2graph.html">bioplex2graph</a></span><span class="op">(</span><span class="va">bp.293t</span><span class="op">)</span></code></pre></div>
<p>Annotate PFAM domains to the node metadata:</p>
<p>Connect to <a href="http://bioconductor.org/packages/AnnotationHub">AnnotationHub</a>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ah</span> <span class="op">&lt;-</span> <span class="fu">AnnotationHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html">AnnotationHub</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>OrgDb package for human:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ahdb</span> <span class="op">&lt;-</span> <span class="fu">AnnotationHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html">query</a></span><span class="op">(</span><span class="va">ah</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orgDb"</span>, <span class="st">"Homo sapiens"</span><span class="op">)</span><span class="op">)</span>
<span class="va">orgdb</span> <span class="op">&lt;-</span> <span class="va">ahdb</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ahdb</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>
<span class="va">orgdb</span></code></pre></div>
<pre><code>## OrgDb object:
## | DBSCHEMAVERSION: 2.1
## | Db type: OrgDb
## | Supporting package: AnnotationDbi
## | DBSCHEMA: HUMAN_DB
## | ORGANISM: Homo sapiens
## | SPECIES: Human
## | EGSOURCEDATE: 2021-Apr14
## | EGSOURCENAME: Entrez Gene
## | EGSOURCEURL: ftp://ftp.ncbi.nlm.nih.gov/gene/DATA
## | CENTRALID: EG
## | TAXID: 9606
## | GOSOURCENAME: Gene Ontology
## | GOSOURCEURL: http://current.geneontology.org/ontology/go-basic.obo
## | GOSOURCEDATE: 2021-02-01
## | GOEGSOURCEDATE: 2021-Apr14
## | GOEGSOURCENAME: Entrez Gene
## | GOEGSOURCEURL: ftp://ftp.ncbi.nlm.nih.gov/gene/DATA
## | KEGGSOURCENAME: KEGG GENOME
## | KEGGSOURCEURL: ftp://ftp.genome.jp/pub/kegg/genomes
## | KEGGSOURCEDATE: 2011-Mar15
## | GPSOURCENAME: UCSC Genome Bioinformatics (Homo sapiens)
## | GPSOURCEURL: 
## | GPSOURCEDATE: 2021-Feb16
## | ENSOURCEDATE: 2021-Feb16
## | ENSOURCENAME: Ensembl
## | ENSOURCEURL: ftp://ftp.ensembl.org/pub/current_fasta
## | UPSOURCENAME: Uniprot
## | UPSOURCEURL: http://www.UniProt.org/
## | UPSOURCEDATE: Mon Apr 26 21:53:12 2021</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">keytypes</a></span><span class="op">(</span><span class="va">orgdb</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "ACCNUM"       "ALIAS"        "ENSEMBL"      "ENSEMBLPROT"  "ENSEMBLTRANS"
##  [6] "ENTREZID"     "ENZYME"       "EVIDENCE"     "EVIDENCEALL"  "GENENAME"    
## [11] "GENETYPE"     "GO"           "GOALL"        "IPI"          "MAP"         
## [16] "OMIM"         "ONTOLOGY"     "ONTOLOGYALL"  "PATH"         "PFAM"        
## [21] "PMID"         "PROSITE"      "REFSEQ"       "SYMBOL"       "UCSCKG"      
## [26] "UNIPROT"</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.gr</span> <span class="op">&lt;-</span> <span class="fu">BioPlex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BioPlex/man/annotatePFAM.html">annotatePFAM</a></span><span class="op">(</span><span class="va">bp.gr</span>, <span class="va">orgdb</span><span class="op">)</span></code></pre></div>
<pre><code>## 'select()' returned 1:many mapping between keys and columns</code></pre>
<p>Domain-domain association analysis:</p>
<ol style="list-style-type: decimal">
<li>create a map from PFAM to UNIPROT</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unip2pfam</span> <span class="op">&lt;-</span> <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/nodeData-methods.html">nodeData</a></span><span class="op">(</span><span class="va">bp.gr</span>, <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html">nodes</a></span><span class="op">(</span><span class="va">bp.gr</span><span class="op">)</span>, <span class="st">"PFAM"</span><span class="op">)</span>
<span class="va">pfam2unip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html">stack</a></span><span class="op">(</span><span class="va">unip2pfam</span><span class="op">)</span>
<span class="va">pfam2unip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">pfam2unip</span><span class="op">$</span><span class="va">ind</span><span class="op">)</span>, <span class="va">pfam2unip</span><span class="op">$</span><span class="va">values</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pfam2unip</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## $PF00001
##  [1] "P28566" "P25106" "P23945" "Q9HBX9" "P16473" "P04201" "Q9HC97" "P30968"
##  [9] "Q9Y2T6" "Q14330" "P46089" "Q15391" "Q9BXA5" "Q13304" "P61073" "P21462"
## [17] "P25090" "Q99679" "P21730" "P30556" "P43088" "P32246" "P32249" "Q9Y2T5"
## [25] "Q7Z602" "P43657" "O00398" "Q9H244" "Q86VZ1" "Q9NPB9" "Q99788" "P51684"
## [33] "P35414" "O00590" "Q9H1Y3" "P55085" "O15218" "Q9GZQ4" "P25101" "Q9NS66"
## [41] "Q9NQS5" "P21453" "P14416" "P24530" "P32239" "Q16581" "O00421" "Q9UHM6"
## [49] "Q8N6U8" "P20309" "O15354" "Q9BXC0" "P47775" "P30550" "P49146" "P47900"
## [57] "Q8TDU9" "P25103" "P35372" "P41597" "Q9P296" "P28335" "O95136" "P08173"
## [65] "P29371" "P41146" "P43119" "O95977" "Q9HBW0" "Q99677" "Q9BXB1" "Q8WXD0"
## [73] "O43193" "P30989" "Q8NGU9" "P47901" "P22888" "Q9GZN0" "P21917" "O60755"
## [81] "Q8TDV0" "O43614" "Q9NS67" "P08912" "Q9UPC5" "Q8TDV2" "Q92633" "Q9NQ55"
## [89] "Q13585" "Q9UBY5" "Q9H228" "P28222"
## 
## $PF00002
##  [1] "Q8IZP9" "P41587" "Q8IZF4" "P49190" "P32241" "P47871" "P48960" "Q8IZF5"
##  [9] "O14514" "Q03431" "Q9NYQ6" "Q9HCU4" "Q8WXG9" "Q9NYQ7" "O60242" "O60241"
## [17] "Q9HAR2" "O94910" "Q8IWK6" "O95490" "Q96PE1" "Q86SQ4"</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>create a map from UNIPROT to PFAMs of interaction partners</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unip2iapfams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html">nodes</a></span><span class="op">(</span><span class="va">bp.gr</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/nodeData-methods.html">nodeData</a></span><span class="op">(</span><span class="va">bp.gr</span>, <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html">edges</a></span><span class="op">(</span><span class="va">bp.gr</span><span class="op">)</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span>, <span class="st">"PFAM"</span><span class="op">)</span><span class="op">)</span>
<span class="va">unip2iapfams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">unip2iapfams</span>, <span class="va">unlist</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">unip2iapfams</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html">nodes</a></span><span class="op">(</span><span class="va">bp.gr</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>for each pfam, get the pfams of interacting proteins</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfam2iapfams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">pfam2unip</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ps</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">unip2iapfams</span><span class="op">[</span><span class="va">ps</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">pfam2iapfams</span> <span class="op">&lt;-</span> <span class="va">pfam2iapfams</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span><span class="op">(</span><span class="va">pfam2iapfams</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>
<span class="va">pfam2pfam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html">stack</a></span><span class="op">(</span><span class="va">pfam2iapfams</span><span class="op">)</span>
<span class="va">pfam2pfam</span><span class="op">$</span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">pfam2pfam</span><span class="op">$</span><span class="va">ind</span><span class="op">)</span> 
<span class="va">pfam2pfam</span> <span class="op">&lt;-</span> <span class="va">pfam2pfam</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">pfam2pfam</span><span class="op">$</span><span class="va">values</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">pfam2pfam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">pfam2pfam</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pfam2pfam</span><span class="op">)</span></code></pre></div>
<pre><code>##   values    ind      
## 1 "PF02874" "PF00001"
## 2 "PF00006" "PF00001"
## 3 "PF02874" "PF00001"
## 4 "PF00006" "PF00001"
## 5 "PF02874" "PF00001"
## 6 "PF00006" "PF00001"</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>compute an all-against-all matrix storing pfam2pfam interaction counts:</li>
</ol>
<p>4a. initialize + turn pfam2pfam mapping into an integer index mapping for efficiency</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">pfam2pfam</span><span class="op">)</span><span class="op">)</span>
<span class="va">len</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pfams</span><span class="op">)</span>
<span class="va">ia.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">len</span>, ncol <span class="op">=</span> <span class="va">len</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ia.mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-toTable.html">colnames</a></span><span class="op">(</span><span class="va">ia.mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pfams</span>
<span class="va">ind1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">pfam2pfam</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">pfams</span><span class="op">)</span>
<span class="va">ind2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">pfam2pfam</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">pfams</span><span class="op">)</span>
<span class="va">pfam2pfam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ind1</span>, <span class="va">ind2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pfam2pfam</span><span class="op">)</span></code></pre></div>
<pre><code>##      ind1 ind2
## [1,]    1  178
## [2,]    2  178
## [3,]    1  178
## [4,]    2  178
## [5,]    1  178
## [6,]    2  178</code></pre>
<p>4b. loop over all pfam-pfam pair and count the PPIs connecting them:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">len</span><span class="op">)</span><span class="op">)</span>
<span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">%%</span> <span class="fl">100</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
    <span class="va">p2p</span> <span class="op">&lt;-</span> <span class="va">pfam2pfam</span><span class="op">[</span><span class="va">pfam2pfam</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">i</span> <span class="op">|</span>  <span class="va">pfam2pfam</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">==</span> <span class="va">i</span>,,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>
    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-toTable.html">nrow</a></span><span class="op">(</span><span class="va">p2p</span><span class="op">)</span><span class="op">)</span>
    <span class="op">{</span>  
      <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">i</span><span class="op">:</span><span class="va">len</span><span class="op">)</span>
      <span class="op">{</span>
          <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="va">j</span><span class="op">)</span> <span class="va">ia.mat</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p2p</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">j</span> <span class="op">&amp;</span> <span class="va">p2p</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">==</span> <span class="va">j</span><span class="op">)</span>
          <span class="kw">else</span> <span class="va">ia.mat</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p2p</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">j</span> <span class="op">|</span> <span class="va">p2p</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">==</span> <span class="va">j</span><span class="op">)</span>
      <span class="op">}</span>
    <span class="op">}</span>  
<span class="op">}</span></code></pre></div>
<pre><code>## 100</code></pre>
<pre><code>## 200</code></pre>
<pre><code>## 300</code></pre>
<pre><code>## 400</code></pre>
<pre><code>## 500</code></pre>
<pre><code>## 600</code></pre>
<pre><code>## 700</code></pre>
<pre><code>## 800</code></pre>
<pre><code>## 900</code></pre>
<pre><code>## 1000</code></pre>
<pre><code>## 1100</code></pre>
<pre><code>## 1200</code></pre>
<pre><code>## 1300</code></pre>
<pre><code>## 1400</code></pre>
<pre><code>## 1500</code></pre>
<pre><code>## 1600</code></pre>
<pre><code>## 1700</code></pre>
<pre><code>## 1800</code></pre>
<pre><code>## 1900</code></pre>
<pre><code>## 2000</code></pre>
<pre><code>## 2100</code></pre>
<pre><code>## 2200</code></pre>
<pre><code>## 2300</code></pre>
<pre><code>## 2400</code></pre>
<pre><code>## 2500</code></pre>
<pre><code>## 2600</code></pre>
<pre><code>## 2700</code></pre>
<pre><code>## 2800</code></pre>
<pre><code>## 2900</code></pre>
<pre><code>## 3000</code></pre>
<pre><code>## 3100</code></pre>
<pre><code>## 3200</code></pre>
<pre><code>## 3300</code></pre>
<pre><code>## 3400</code></pre>
<pre><code>## 3500</code></pre>
<pre><code>## 3600</code></pre>
<pre><code>## 3700</code></pre>
<pre><code>## 3800</code></pre>
<pre><code>## 3900</code></pre>
<pre><code>## 4000</code></pre>
<pre><code>## 4100</code></pre>
<pre><code>## 4200</code></pre>
<pre><code>## 4300</code></pre>
<pre><code>## 4400</code></pre>
<pre><code>## 4500</code></pre>
<pre><code>## 4600</code></pre>
<pre><code>## 4700</code></pre>
<pre><code>## 4800</code></pre>
<pre><code>## 4900</code></pre>
<pre><code>## 5000</code></pre>
<pre><code>## 5100</code></pre>
<pre><code>## 5200</code></pre>
<pre><code>## 5300</code></pre>
<pre><code>## 5400</code></pre>
<p>Inspect the result:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">ia.mat</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 5416 5416</code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ia.mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></code></pre></div>
<pre><code>##         PF02874 PF00006 PF00306 PF02823 PF00213
## PF02874       4       8       1       2       1
## PF00006       0       4       1       2       1
## PF00306       0       0       0       1       0
## PF02823       0       0       0       0       1
## PF00213       0       0       0       0       0</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>filter out pfams that have not at least one pfam with 2 interactions</li>
</ol>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ia.mat</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">ia.mat</span> <span class="op">&lt;-</span> <span class="va">ia.mat</span><span class="op">[</span><span class="va">gr1</span> , <span class="va">gr1</span><span class="op">]</span> 
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">ia.mat</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 2281 2281</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>calculate 2x2 contigency tables for all domain pairs:</li>
</ol>
<p>6a. Let’s do some precomputations of the margins for efficiency</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">ia.mat</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="va">ia.mat</span>
<span class="va">m</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">]</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code></pre></div>
<p>6b. let’s define a function that computes for each domain pair: 1) the number of interactions connecting both domains; 2) the numbers of interactions involving either domain individually; and 3) the number of interactions not involving either domain</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">getContingency</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">m</span>, <span class="va">rs</span>, <span class="va">total</span><span class="op">)</span> 
<span class="op">{</span>
    <span class="va">both</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">[</span><span class="va">p1</span>,<span class="va">p2</span><span class="op">]</span>
    <span class="va">one</span> <span class="op">&lt;-</span> <span class="va">rs</span><span class="op">[</span><span class="va">p1</span><span class="op">]</span> <span class="op">-</span> <span class="va">both</span>
    <span class="va">two</span> <span class="op">&lt;-</span> <span class="va">rs</span><span class="op">[</span><span class="va">p2</span><span class="op">]</span> <span class="op">-</span> <span class="va">both</span>
    <span class="va">all</span> <span class="op">&lt;-</span> <span class="va">total</span> <span class="op">-</span> <span class="va">one</span> <span class="op">-</span> <span class="va">two</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">both</span>, <span class="va">one</span>, <span class="va">two</span>, <span class="va">all</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">getContingency</span><span class="op">(</span><span class="st">"PF02874"</span>, <span class="st">"PF00006"</span>, <span class="va">m</span>, <span class="va">rs</span>, <span class="va">total</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]      8     89     89 183050</code></pre>
<p>6c. now let’s get all possible domain pairs and restrict to those pairs connected by at least 2 PPI’s:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">combs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">combs</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">m</span><span class="op">[</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">combs</span> <span class="op">&lt;-</span> <span class="va">combs</span><span class="op">[</span>,<span class="va">ind</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">combs</span><span class="op">)</span></code></pre></div>
<pre><code>## [1]     2 29118</code></pre>
<p>6d. calculate contigency for all remaining domain pairs:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">combs</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">getContingency</span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">m</span>, <span class="va">rs</span>, <span class="va">total</span><span class="op">)</span><span class="op">)</span> 
<span class="va">conts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">conts</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">conts</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]   [,4]
## [1,]    8   89   89 183050
## [2,]    2   95   28 183105
## [3,]    3   94  488 182646
## [4,]   15   82 3879 179267
## [5,]    3   94 1575 181559
## [6,]    5   92 4228 178908</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Now we test each domain pair for over-representation of connecting PPI’s based on the hypergeometric distribution. This corresponds to a one-sided version of Fisher’s exact test:</li>
</ol>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fisherp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">x</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, 
                       alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> 
<span class="fu">fisherp</span><span class="op">(</span><span class="va">conts</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 6.377725e-16</code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">conts</span>, <span class="fl">1</span>, <span class="va">fisherp</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 6.377725e-16 1.194922e-04 2.339281e-03 2.382686e-09 5.183170e-02
## [6] 7.463328e-02</code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">ps</span>, breaks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<p><img src="PFAM_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<ol start="8" style="list-style-type: decimal">
<li>Multiple testing correction:</li>
</ol>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">adjp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span><span class="op">(</span><span class="va">ps</span>, method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span></code></pre></div>
<p>RESULT:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>PFAM1 <span class="op">=</span> <span class="va">combs</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, 
                  PFAM2 <span class="op">=</span> <span class="va">combs</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,
                  PVAL <span class="op">=</span> <span class="va">ps</span>,
                  ADJ.PVAL <span class="op">=</span> <span class="va">adjp</span><span class="op">)</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<pre><code>##         PFAM1   PFAM2          PVAL      ADJ.PVAL
## 29095 PF00227 PF10584 3.174323e-213 9.242994e-209
## 22223 PF00096 PF02023 1.401595e-158 2.040582e-154
## 4177  PF08266 PF00028 2.023701e-157 1.964204e-153
## 11246 PF00400 PF00118 5.480606e-136 3.989607e-132
## 4062  PF15974 PF08266 8.734846e-125 5.086825e-121
## 4063  PF15974 PF00028 3.371853e-117 1.636360e-113</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Get human readable description for the PFAM domain IDs:</li>
</ol>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">PFAM.db</span><span class="op">)</span></code></pre></div>
<pre><code>## </code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">id2de</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/BimapFormatting.html">as.list</a></span><span class="op">(</span><span class="va">PFAMDE</span><span class="op">)</span></code></pre></div>
<p>What are the top 10 interacting domains:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">id2de</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">PFAM1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span>,
      <span class="va">id2de</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">PFAM2</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##         [,1]                                                          
## PF00227 "Proteasome subunit"                                          
## PF00096 "Zinc finger, C2H2 type"                                      
## PF08266 "Cadherin-like"                                               
## PF00400 "WD domain, G-beta repeat"                                    
## PF15974 "Cadherin C-terminal cytoplasmic tail, catenin-binding region"
## PF15974 "Cadherin C-terminal cytoplasmic tail, catenin-binding region"
## PF08266 "Cadherin-like"                                               
## PF00631 "GGL domain"                                                  
## PF00028 "Cadherin domain"                                             
## PF05739 "SNARE domain"                                                
##         [,2]                                       
## PF00227 "Proteasome subunit A N-terminal signature"
## PF00096 "SCAN domain"                              
## PF08266 "Cadherin domain"                          
## PF00400 "TCP-1/cpn60 chaperonin family"            
## PF15974 "Cadherin-like"                            
## PF15974 "Cadherin domain"                          
## PF08266 "Cadherin cytoplasmic C-terminal"          
## PF00631 "G-protein alpha subunit"                  
## PF00028 "Cadherin cytoplasmic C-terminal"          
## PF05739 "Synaptobrevin"</code></pre>
<p>Can we do some of this vectorized ?</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">.f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">rs</span>, <span class="va">total</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">one</span> <span class="op">&lt;-</span> <span class="va">rs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span>
  <span class="va">two</span> <span class="op">&lt;-</span> <span class="va">rs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span>
  <span class="va">all</span> <span class="op">&lt;-</span> <span class="va">total</span> <span class="op">-</span> <span class="va">one</span> <span class="op">-</span> <span class="va">two</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">one</span>, <span class="va">two</span>, <span class="va">all</span><span class="op">)</span>
<span class="op">}</span>      </code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ludwig Geistlinger, Robert Gentleman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
