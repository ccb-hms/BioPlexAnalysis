<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CORUM complex overlap analysis • BioPlexAnalysis</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CORUM complex overlap analysis">
<meta property="og:description" content="BioPlexAnalysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioPlexAnalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BioNet.html">Maximum scoring subnetwork analysis</a>
    </li>
    <li>
      <a href="../articles/CORUM.html">Protein complex overlap analysis</a>
    </li>
    <li>
      <a href="../articles/PDB.html">Mapping PPIs onto 3D protein structures</a>
    </li>
    <li>
      <a href="../articles/PFAM.html">Protein domain association analysis</a>
    </li>
    <li>
      <a href="../articles/TranscriptomeProteome.html">Transcriptome and Proteome analysis</a>
    </li>
    <li>
      <a href="../articles/GraphFrames.html">GraphFrames backend</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ccb-hms/BioPlexAnalysis" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CORUM complex overlap analysis</h1>
            
      
      
      <div class="hidden name"><code>CORUM.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ccb-hms/BioPlex" class="external-link">BioPlex</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/" class="external-link">reticulate</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-retrieval">Data retrieval<a class="anchor" aria-label="anchor" href="#data-retrieval"></a>
</h2>
<p>Get the latest version of the 293T PPI network …</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.293t.3</span> <span class="op">&lt;-</span> <span class="fu">BioPlex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BioPlex/man/getBioPlex.html" class="external-link">getBioPlex</a></span><span class="op">(</span>cell.line <span class="op">=</span> <span class="st">"293T"</span>, version <span class="op">=</span> <span class="st">"3.0"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Using cached version from 2023-01-06 19:10:56</span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bp.293t.3</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    GeneA  GeneB UniprotA UniprotB SymbolA SymbolB           pW          pNI</span>
<span class="co">## 1    100 728378   P00813   A5A3E0     ADA   POTEF 6.881844e-10 0.0001176357</span>
<span class="co">## 2 222389   6137 Q8N7W2-2   P26373   BEND7   RPL13 1.340380e-18 0.2256644741</span>
<span class="co">## 3 222389   5928 Q8N7W2-2 Q09028-3   BEND7   RBBP4 7.221401e-21 0.0000641669</span>
<span class="co">## 4 222389  25873 Q8N7W2-2   Q9Y3U8   BEND7   RPL36 7.058372e-17 0.1281827343</span>
<span class="co">## 5 222389   6124 Q8N7W2-2   P36578   BEND7    RPL4 1.632313e-22 0.2006379109</span>
<span class="co">## 6 222389   6188 Q8N7W2-2   P23396   BEND7    RPS3 3.986270e-26 0.0010264311</span>
<span class="co">##        pInt</span>
<span class="co">## 1 0.9998824</span>
<span class="co">## 2 0.7743355</span>
<span class="co">## 3 0.9999358</span>
<span class="co">## 4 0.8718173</span>
<span class="co">## 5 0.7993621</span>
<span class="co">## 6 0.9989736</span></code></pre>
<p>… and turn into a graph:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gr.293t.3</span> <span class="op">&lt;-</span> <span class="fu">BioPlex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BioPlex/man/bioplex2graph.html" class="external-link">bioplex2graph</a></span><span class="op">(</span><span class="va">bp.293t.3</span><span class="op">)</span></code></pre></div>
<p>Obtain the complete set of human protein complexes from CORUM …</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corum.df</span> <span class="op">&lt;-</span> <span class="fu">BioPlex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BioPlex/man/getCorum.html" class="external-link">getCorum</a></span><span class="op">(</span>set <span class="op">=</span> <span class="st">"core"</span>, organism <span class="op">=</span> <span class="st">"Human"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Using cached version from 2023-01-06 19:38:27</span></code></pre>
<p>… and turn into a <code>list</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corum.list</span> <span class="op">&lt;-</span> <span class="fu">BioPlex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BioPlex/man/corum2list.html" class="external-link">corum2list</a></span><span class="op">(</span><span class="va">corum.df</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">corum.list</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## $`CORUM1_BCL6-HDAC4_complex`</span>
<span class="co">## [1] "P41182" "P56524"</span>
<span class="co">## </span>
<span class="co">## $`CORUM2_BCL6-HDAC5_complex`</span>
<span class="co">## [1] "P41182" "Q9UQL6"</span>
<span class="co">## </span>
<span class="co">## $`CORUM3_BCL6-HDAC7_complex`</span>
<span class="co">## [1] "P41182" "Q8WUI4"</span>
<span class="co">## </span>
<span class="co">## $CORUM4_Multisubunit_ACTR_coactivator_complex</span>
<span class="co">## [1] "Q09472" "Q92793" "Q92831" "Q9Y6Q9"</span>
<span class="co">## </span>
<span class="co">## $`CORUM11_BLOC-3_(biogenesis_of_lysosome-related_organelles_complex_3)`</span>
<span class="co">## [1] "Q92902" "Q9NQG7"</span>
<span class="co">## </span>
<span class="co">## $`CORUM12_BLOC-2_(biogenesis_of_lysosome-related_organelles_complex_2)`</span>
<span class="co">## [1] "Q86YV9" "Q969F9" "Q9UPZ3"</span></code></pre>
<p>Identify complexes with at least three subunits:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hasSubunits</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span>, <span class="va">gr</span><span class="op">)</span>
<span class="op">{</span>
    <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">s</span>, <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html" class="external-link">nodes</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span>
<span class="op">}</span>
<span class="va">has.subunits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">corum.list</span>, <span class="va">hasSubunits</span>, <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, gr <span class="op">=</span> <span class="va">gr.293t.3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">has.subunits</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## has.subunits</span>
<span class="co">## FALSE  TRUE </span>
<span class="co">##  1026  1391</span></code></pre>
<p>Identify complexes with at least one subunit targeted as bait:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hasBait</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span>, <span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">s</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">df</span><span class="op">$</span><span class="va">UniprotA</span><span class="op">)</span>
<span class="va">has.bait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">corum.list</span>, <span class="va">hasBait</span>, <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">bp.293t.3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">has.bait</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## has.bait</span>
<span class="co">## FALSE  TRUE </span>
<span class="co">##   724  1693</span></code></pre>
<p>Identify complexes with at least one PPI between subunits:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hasEdge</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span>, <span class="va">gr</span><span class="op">)</span>
<span class="op">{</span>
    <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">s</span>, <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html" class="external-link">nodes</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span><span class="op">)</span>
    <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graph-class.html" class="external-link">numEdges</a></span><span class="op">(</span><span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/subGraph.html" class="external-link">subGraph</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">gr</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>
<span class="op">}</span>
<span class="va">has.edge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">corum.list</span>, <span class="va">hasEdge</span>, <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, gr <span class="op">=</span> <span class="va">gr.293t.3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">has.edge</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## has.edge</span>
<span class="co">## FALSE  TRUE </span>
<span class="co">##  1232  1185</span></code></pre>
<p>We then subset the CORUM complexes to those having (i) at least three
subunits, (ii) at least one subunit targeted as bait, and (iii) at least
one PPI between subunits.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind</span> <span class="op">&lt;-</span> <span class="va">has.subunits</span> <span class="op">&amp;</span> <span class="va">has.bait</span> <span class="op">&amp;</span> <span class="va">has.edge</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ind</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## ind</span>
<span class="co">## FALSE  TRUE </span>
<span class="co">##  1509   908</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sub.corum.list</span> <span class="op">&lt;-</span> <span class="va">corum.list</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overlap-analysis-with-protein-complexes-random-sampling">Overlap analysis with protein complexes (random sampling)<a class="anchor" aria-label="anchor" href="#overlap-analysis-with-protein-complexes-random-sampling"></a>
</h2>
<p>The <a href="https://pypi.org/project/bioplexpy/" class="external-link">bioplexpy</a>
package implements a function for testing overlaps of PPIs with a
complex of interest based on random sampling.</p>
<p>The function samples random subnetworks from the given PPI network,
matching the number of subunits and the bait:prey ratio of the complex
being tested. We then count the number of interactions in each
replication, and compare against the observed number of interactions
overlapping with the complex.</p>
<p>Here, we set up a python environment via <a href="https://rstudio.github.io/reticulate/" class="external-link">reticulate</a> that
contains the <a href="https://pypi.org/project/bioplexpy/" class="external-link">bioplexpy</a>
package in order to invoke the function from within R, facilitating
direct exchange of data and results between the BioPlex R and BioPlex
Python packages:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/virtualenv-tools.html" class="external-link">virtualenv_create</a></span><span class="op">(</span><span class="st">"r-reticulate"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## virtualenv: r-reticulate</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/virtualenv-tools.html" class="external-link">virtualenv_install</a></span><span class="op">(</span><span class="st">"r-reticulate"</span>, <span class="st">"bioplexpy"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Using virtual environment 'r-reticulate' ...</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_virtualenv</a></span><span class="op">(</span><span class="st">"r-reticulate"</span><span class="op">)</span>
<span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"bioplexpy"</span><span class="op">)</span></code></pre></div>
<p>Here, we use a functionality from the BioPlex Python package to turn
the BioPlex data into a <a href="https://networkx.org/" class="external-link">NetworkX</a>
graph:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gr</span> <span class="op">&lt;-</span> <span class="va">bp</span><span class="op">$</span><span class="fu">bioplex2graph</span><span class="op">(</span><span class="va">bp.293t.3</span><span class="op">)</span>
<span class="va">gr</span></code></pre></div>
<pre><code><span class="co">## &lt;networkx.classes.digraph.DiGraph object at 0x7f9774105700&gt;</span></code></pre>
<p>and also to obtain the subset of CORUM complexes satisfying the above
criteria.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corum</span> <span class="op">&lt;-</span> <span class="va">bp</span><span class="op">$</span><span class="fu">getCorum</span><span class="op">(</span>complex_set <span class="op">=</span> <span class="st">"core"</span>, organism <span class="op">=</span> <span class="st">"Human"</span><span class="op">)</span>
<span class="va">sub.corum</span> <span class="op">&lt;-</span> <span class="va">corum</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span> </code></pre></div>
<p>Now we carry out the overlap resampling test as implemented in the
<code>bioplexpy</code> package for all complexes passing the filter
criteria:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">sub.corum</span><span class="op">$</span><span class="va">ComplexID</span>,
             <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="va">bp</span><span class="op">$</span><span class="fu">permutation_test_for_CORUM_complex</span><span class="op">(</span><span class="va">gr</span>, <span class="va">sub.corum</span>, <span class="va">i</span>, <span class="fl">100</span><span class="op">)</span>,
             <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.00990099 0.00990099 0.00990099 0.00990099 0.00990099 0.00990099</span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="co">## 0.009901 0.009901 0.009901 0.011646 0.009901 0.207921</span></code></pre>
<p>We can now take a peak at the p-value distribution from the overlap
permutation test, observing a strong concentration near zero, confirming
that, as expected, many complexes are enriched for PPIs - when compared
to random subsets of the overall PPIs network matching the complexes in
size and composition.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ps</span>, breaks <span class="op">=</span> <span class="fl">20</span>, xlab <span class="op">=</span> <span class="st">"p-value"</span>, ylab <span class="op">=</span> <span class="st">"frequency"</span>, col <span class="op">=</span> <span class="st">"#00AFBB"</span><span class="op">)</span></code></pre></div>
<p><img src="CORUM_files/figure-html/p-hist-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="overlap-analysis-with-protein-complexes-network-randomization">Overlap analysis with protein complexes (network randomization)<a class="anchor" aria-label="anchor" href="#overlap-analysis-with-protein-complexes-network-randomization"></a>
</h2>
<p>The resampling test implemented in the BioPlex Python package
addresses the question: given a specific network topology, how likely is
it that <em>n</em> nodes are connected by at least <em>m</em> edges? In
the spirit of a competitive enrichment test, we therefore assess whether
the connectivity within the protein set of interest exceeds the
connectivity outside of the protein set of interest (= overall /
background connectivity).</p>
<p>It is also possible to test each complex for enrichment of PPIs based
on network randomization as implemented in the <a href="https://bioconductor.org/packages/BiRewire" class="external-link">BiRewire</a> package.
This addresses the question: in networks of different topology but the
same node degree distribution, how likely is it that <em>n</em> nodes
are connected by at least <em>m</em> edges? The network randomization
test thus randomizes the overall network while keeping the protein set
of interest fixed (in contrast to the resampling test, which randomizes
the protein set of interest while keeping the overall network
fixed).</p>
<p>This approach is incorporated in the <code>testConnectivity</code>
function, which we apply here to test all CORUM complexes that were
passing the filter criteria above. We therefore randomize the PPI
network a defined number of times (here: 100 times), and calculate for
each complex how often the number of edges in a randomized configuration
exceeded the number of edges observed for the true PPI network.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ps2</span> <span class="op">&lt;-</span> <span class="fu">BioPlexAnalysis</span><span class="fu">::</span><span class="fu"><a href="../reference/testConnectivity.html">testConnectivity</a></span><span class="op">(</span><span class="va">sub.corum.list</span>, 
                                         <span class="va">gr.293t.3</span>,
                                         nr.reps <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## CORUM12_BLOC-2_(biogenesis_of_lysosome-related_organelles_complex_2) </span>
<span class="co">##                                                           0.09090909 </span>
<span class="co">##                                                 CORUM15_NCOR_complex </span>
<span class="co">##                                                           0.09090909 </span>
<span class="co">## CORUM23_BLOC-1_(biogenesis_of_lysosome-related_organelles_complex_1) </span>
<span class="co">##                                                           0.09090909 </span>
<span class="co">##                                       CORUM27_Arp2/3_protein_complex </span>
<span class="co">##                                                           0.09090909 </span>
<span class="co">##                                                CORUM32_PA700_complex </span>
<span class="co">##                                                           0.09090909 </span>
<span class="co">##                                          CORUM36_AP1_adaptor_complex </span>
<span class="co">##                                                           0.09090909</span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">## 0.09091 0.09091 0.09091 0.09291 0.09091 0.72727</span></code></pre>
<p>As before we can take a peak at the <em>p</em>-value distribution for
the network randomization test, which displays as for the resampling
test a strong enrichment of PPIs across almost all CORUM complexes.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">ps2</span>, breaks <span class="op">=</span> <span class="fl">20</span>, xlab <span class="op">=</span> <span class="st">"p-value"</span>, ylab <span class="op">=</span> <span class="st">"frequency"</span>, col <span class="op">=</span> <span class="st">"#00AFBB"</span><span class="op">)</span></code></pre></div>
<p><img src="CORUM_files/figure-html/p-hist2-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ludwig Geistlinger, Robert Gentleman.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
